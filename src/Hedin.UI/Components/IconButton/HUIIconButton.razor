@namespace Hedin.UI

<HUITooltip PointerEvents="@TooltipPointerEvents" Text="@Tooltip">
    <MudIconButton Target="@Target" Size="Size.Small" Variant="Variant" Icon="@(!Loading ? Icon : null)" OnClick="@OnClick" Disabled="Loading || Disabled" Color="Color" DropShadow="false" Href="@Href" Style="@MergedStyle">
        @if (Loading)
        {
            <MudProgressCircular Class="mt-1" Color="Color.Info" Size="Size.Small" Indeterminate="true" />
        }
    </MudIconButton>
</HUITooltip>

@code {
    [CascadingParameter(Name = "GroupedMode")] public bool Grouped { get; set; }
    [CascadingParameter] public string? StyleFromColumn { get; set; }
    /// <summary>
    /// Shows a progress icon when Loading is true
    /// </summary>
    [Parameter] public bool Loading { get; set; }
    [Parameter] public string? Tooltip { get; set; }
    [Parameter] public Color Color { get; set; } = Color.Default;
    [Parameter] public Variant Variant { get; set; } = Variant.Outlined;
    [Parameter] public string? Icon { get; set; }
    /// <summary>
    /// The URL to navigate to when the button is clicked.
    /// <remarks>Defaults to null. When clicked, the browser will navigate to this URL. Use the Target property to target a specific tab.</remarks> 
    /// </summary>
    [Parameter] public string? Href { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public string Style { get; set; }
    [Parameter] public string Target { get; set; }
    /// <summary>
    /// Set the pointer events CSS property on the tooltip. auto is the default value.
    /// Suitable values are "none", "auto", "visible", "visibleFill", "visiblePainted", and "visibleStroke".
    /// </summary>
    [Parameter] public string TooltipPointerEvents { get; set; } = "auto";

    private string MergedStyle => $"{(Grouped ? $"{StyleFromColumn} {GroupedStyle}" : StyleFromColumn)} {Style}".Trim();
    private const string GroupedStyle = "margin-left: -6px; margin-right: -6px; padding-left: 12px; padding-right: 12px;";
}